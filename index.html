<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha256-XOqroi11tY4EFQMR9ZYwZWKj5ZXiftSx36RRuC3anlA=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"a-cs99.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.20.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="分享个人学习与实战经历">
<meta property="og:type" content="website">
<meta property="og:title" content="ACS99的个人博客">
<meta property="og:url" content="http://a-cs99.github.io/">
<meta property="og:site_name" content="ACS99的个人博客">
<meta property="og:description" content="分享个人学习与实战经历">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Jiaming He">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://a-cs99.github.io/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-CN","comments":"","permalink":"","path":"index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>ACS99的个人博客</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">ACS99的个人博客</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">作者Jiaming He</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Jiaming He</p>
  <div class="site-description" itemprop="description">分享个人学习与实战经历</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">3</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">8</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>

        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="返回顶部">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://a-cs99.github.io/2024/07/31/Code-PRS-Net/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Jiaming He">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ACS99的个人博客">
      <meta itemprop="description" content="分享个人学习与实战经历">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | ACS99的个人博客">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/07/31/Code-PRS-Net/" class="post-title-link" itemprop="url">PRS-Net误差和网络的代码实现</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2024-07-31 16:08:33 / 修改时间：19:25:28" itemprop="dateCreated datePublished" datetime="2024-07-31T16:08:33+08:00">2024-07-31</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E8%AE%BA%E6%96%87%E5%A4%8D%E7%8E%B0/" itemprop="url" rel="index"><span itemprop="name">论文复现</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E8%AE%BA%E6%96%87%E5%A4%8D%E7%8E%B0/Python%E7%A8%8B%E5%BA%8F/" itemprop="url" rel="index"><span itemprop="name">Python程序</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E8%AE%BA%E6%96%87%E5%A4%8D%E7%8E%B0/Python%E7%A8%8B%E5%BA%8F/%E4%B8%89%E7%BB%B4%E5%9B%BE%E5%BD%A2%E5%AD%A6/" itemprop="url" rel="index"><span itemprop="name">三维图形学</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <blockquote>
<p>论文原文：<a target="_blank" rel="noopener" href="https://arxiv.org/abs/1910.06511v6">PRS-Net: Planar Reflective Symmetry Detection Network</a></p>
</blockquote>
<h1 id="1-本文目的"><a class="markdownIt-Anchor" href="#1-本文目的"></a> 1 本文目的</h1>
<p>探讨如何使用PyTorch实现PRS-Net的网络结构，以及如何计算误差</p>
<h1 id="2-数据集及环境"><a class="markdownIt-Anchor" href="#2-数据集及环境"></a> 2 数据集及环境</h1>
<ul>
<li>ShapeNetCore.v2经过体素化的模型</li>
<li>CUDA 12.3</li>
</ul>
<h1 id="3-误差计算"><a class="markdownIt-Anchor" href="#3-误差计算"></a> 3 误差计算</h1>
<p>误差计算实现中均使用PyTorch的mathematical functions进行张量计算，以便于在GPU上加速和进行反向传播</p>
<h2 id="31-对称距离损失symmetry-distance-loss"><a class="markdownIt-Anchor" href="#31-对称距离损失symmetry-distance-loss"></a> 3.1 对称距离损失（Symmetry Distance Loss）</h2>
<p>惩罚对称距离较远（即对称后偏离较大）的对称面/旋转轴</p>
<h3 id="311-计算对称-旋转后的点云"><a class="markdownIt-Anchor" href="#311-计算对称-旋转后的点云"></a> 3.1.1 计算对称、旋转后的点云</h3>
<p>关于待验证的对称面和对称轴，对原始样本点云进行对称和旋转变换</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">quat2Rmatrix</span>(<span class="params">quaternion: torch.Tensor</span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    将四元数转换为旋转矩阵</span></span><br><span class="line"><span class="string">    @param quaternion: 旋转四元数 1x4</span></span><br><span class="line"><span class="string">    @return rotation_matrix: 旋转矩阵 3x3</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    w, x, y, z = quaternion</span><br><span class="line">    rotation_matrix = torch.stack([</span><br><span class="line">        torch.stack([<span class="number">1</span>-<span class="number">2</span>*y**<span class="number">2</span>-<span class="number">2</span>*z**<span class="number">2</span>, <span class="number">2</span>*x*y-<span class="number">2</span>*w*z, <span class="number">2</span>*x*z+<span class="number">2</span>*w*y]),</span><br><span class="line">        torch.stack([<span class="number">2</span>*x*y+<span class="number">2</span>*w*z, <span class="number">1</span>-<span class="number">2</span>*x**<span class="number">2</span>-<span class="number">2</span>*z**<span class="number">2</span>, <span class="number">2</span>*y*z-<span class="number">2</span>*w*x]),</span><br><span class="line">        torch.stack([<span class="number">2</span>*x*z-<span class="number">2</span>*w*y, <span class="number">2</span>*y*z+<span class="number">2</span>*w*x, <span class="number">1</span>-<span class="number">2</span>*x**<span class="number">2</span>-<span class="number">2</span>*y**<span class="number">2</span>])</span><br><span class="line">    ])</span><br><span class="line">    <span class="keyword">return</span> rotation_matrix</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">symmetry_points</span>(<span class="params">points: torch.Tensor, plane: torch.Tensor</span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    对称化点云</span></span><br><span class="line"><span class="string">    @param points: 点云 3xN</span></span><br><span class="line"><span class="string">    @param plane: 对称平面 1x4</span></span><br><span class="line"><span class="string">    @return sym_points: 对称化点云 3xN</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="comment"># 1. 截取对称平面的单位法向量 1x3</span></span><br><span class="line">    plane_normal = plane[:<span class="number">3</span>]</span><br><span class="line">    d_value = plane[<span class="number">3</span>]</span><br><span class="line">    L2_norm = torch.norm(plane_normal)</span><br><span class="line">    unit_normal = plane_normal / L2_norm</span><br><span class="line">    <span class="comment"># 2. 计算对称面到点的距离 1xN</span></span><br><span class="line">    dist2plane = torch.sub(torch.matmul(unit_normal, points), d_value)</span><br><span class="line">    <span class="comment"># 3. 计算差值向量（两倍的距离）</span></span><br><span class="line">    t_unit_normal = torch.unsqueeze(unit_normal, dim=<span class="number">1</span>)</span><br><span class="line">    sub_vector = torch.mul(t_unit_normal, dist2plane)</span><br><span class="line">    <span class="comment"># 4. 对称化点云</span></span><br><span class="line">    sym_points = torch.sub(points, sub_vector, alpha=<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">return</span> sym_points</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rotate_points</span>(<span class="params">points: torch.Tensor, quaternion: torch.Tensor</span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    旋转点云</span></span><br><span class="line"><span class="string">    @param points: 点云 3xN</span></span><br><span class="line"><span class="string">    @param quaternion: 旋转四元数 1x4</span></span><br><span class="line"><span class="string">    @return rotated_points: 旋转后的点云 3xN</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="comment"># 1. 计算旋转矩阵</span></span><br><span class="line">    rotation_matrix = quat2Rmatrix(quaternion)</span><br><span class="line">    <span class="comment"># 2. 点云旋转</span></span><br><span class="line">    rotated_points = torch.matmul(rotation_matrix, points)</span><br><span class="line">    <span class="keyword">return</span> rotated_points</span><br></pre></td></tr></table></figure>
<h3 id="312-计算对称距离"><a class="markdownIt-Anchor" href="#312-计算对称距离"></a> 3.1.2 计算对称距离</h3>
<p>对称距离损失为原始样本点云到变换后点云的最短距离之和<br />
将对称面和旋转轴的对称距离损失相加，得到总的对称距离损失</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">shortest_distance</span>(<span class="params">points: torch.Tensor, sample: torch.Tensor</span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    计算点到点云的最短距离</span></span><br><span class="line"><span class="string">    @param points: 点云 3xN</span></span><br><span class="line"><span class="string">    @param sample: 采样点 3x1</span></span><br><span class="line"><span class="string">    @return distance: 最短距离 1xM</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="comment"># 1. 计算所有样本点到点云间的距离</span></span><br><span class="line">    all_distance = torch.norm(torch.sub(points, torch.unsqueeze(sample, dim=<span class="number">1</span>)), dim=<span class="number">0</span>)</span><br><span class="line">    <span class="comment"># 2. 计算最短距离</span></span><br><span class="line">    shortest_distance = torch.<span class="built_in">min</span>(all_distance)</span><br><span class="line">    <span class="keyword">return</span> shortest_distance</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">plane_sde_loss</span>(<span class="params">plane: torch.Tensor, samples: torch.Tensor, points: torch.Tensor, *, device: torch.device</span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    对称距离损失函数</span></span><br><span class="line"><span class="string">    @param plane: 预测的对称平面 1x4</span></span><br><span class="line"><span class="string">    @param samples: 采样点 3xM</span></span><br><span class="line"><span class="string">    @param points: 模型所有顶点 3xN</span></span><br><span class="line"><span class="string">    @param device: 设备</span></span><br><span class="line"><span class="string">    @return plane_loss: 对称距离损失</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="comment"># 计算对称平面的对称距离损失SDE</span></span><br><span class="line">    plane_loss = <span class="number">0</span></span><br><span class="line">    <span class="comment"># 1. 计算对称后的采样点</span></span><br><span class="line">    sym_samples = symmetry_points(samples, plane)</span><br><span class="line">    <span class="comment"># 2. 计算采样点到形状的最短距离</span></span><br><span class="line">    <span class="keyword">for</span> sample <span class="keyword">in</span> sym_samples.transpose(<span class="number">0</span>, <span class="number">1</span>):</span><br><span class="line">        dist = shortest_distance(points, sample)</span><br><span class="line">        <span class="comment"># 3. 累加损失</span></span><br><span class="line">        plane_loss += dist</span><br><span class="line">    <span class="keyword">return</span> plane_loss</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">quat_sde_loss</span>(<span class="params">quaternion: torch.Tensor, samples: torch.Tensor, points: torch.Tensor, *, device: torch.device</span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    对称距离损失函数</span></span><br><span class="line"><span class="string">    @param quaternion: 预测的旋转轴 1x4</span></span><br><span class="line"><span class="string">    @param samples: 采样点 3xM</span></span><br><span class="line"><span class="string">    @param points: 模型所有顶点 3xN</span></span><br><span class="line"><span class="string">    @param device: 设备</span></span><br><span class="line"><span class="string">    @return quaternion_loss: 对称距离损失</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="comment"># 计算旋转轴的对称距离损失SDE</span></span><br><span class="line">    quaternion_loss = <span class="number">0</span></span><br><span class="line">    <span class="comment"># 1. 计算旋转后的采样点</span></span><br><span class="line">    rotated_samples = rotate_points(samples, quaternion)</span><br><span class="line">    <span class="comment"># 2. 计算采样点到形状的最短距离</span></span><br><span class="line">    <span class="keyword">for</span> sample <span class="keyword">in</span> rotated_samples.transpose(<span class="number">0</span>, <span class="number">1</span>):</span><br><span class="line">        dist = shortest_distance(points, sample)</span><br><span class="line">        <span class="comment"># 3. 累加损失</span></span><br><span class="line">        quaternion_loss += dist</span><br><span class="line">    <span class="keyword">return</span> quaternion_loss</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">SDELoss</span>(<span class="params">planes: torch.Tensor, quaternions: torch.Tensor, samples: torch.Tensor, points: torch.Tensor, *, device: torch.device</span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    对称距离损失函数</span></span><br><span class="line"><span class="string">    @param planes: 预测的对称平面 3x4</span></span><br><span class="line"><span class="string">    @param quaternions: 预测的旋转轴 3x4</span></span><br><span class="line"><span class="string">    @param samples: 采样点 3xM</span></span><br><span class="line"><span class="string">    @param points: 模型所有顶点 3xN</span></span><br><span class="line"><span class="string">    @param device: 设备</span></span><br><span class="line"><span class="string">    @return sde_loss: 对称距离损失</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="comment"># 1. 计算对称平面的对称距离损失SDE</span></span><br><span class="line">    plane_loss = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> plane <span class="keyword">in</span> planes:</span><br><span class="line">        plane_loss += plane_sde_loss(plane, samples, points, device=device)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 2. 计算旋转轴的对称距离损失SDE</span></span><br><span class="line">    quaternion_loss = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> quat <span class="keyword">in</span> quaternions:</span><br><span class="line">        quaternion_loss += quat_sde_loss(quat, samples, points, device=device)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 三、计算总损失</span></span><br><span class="line">    sde_loss = plane_loss + quaternion_loss</span><br><span class="line">    <span class="keyword">return</span> sde_loss</span><br></pre></td></tr></table></figure>
<h2 id="32-规范化损失regularization-loss"><a class="markdownIt-Anchor" href="#32-规范化损失regularization-loss"></a> 3.2 规范化损失（Regularization Loss）</h2>
<p>惩罚接近平行的对称面/旋转轴，避免生成重复的对称平面</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">quat2axisangle</span>(<span class="params">quaternion: torch.Tensor</span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    将四元数转换为旋转轴和旋转角</span></span><br><span class="line"><span class="string">    @param quaternion: 旋转四元数 1x4</span></span><br><span class="line"><span class="string">    @return axis: 旋转轴 1x3</span></span><br><span class="line"><span class="string">    @return angle: 旋转角 1x1</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    w, x, y, z = quaternion</span><br><span class="line">    half_angle = torch.acos(w)</span><br><span class="line">    angle = torch.mul(<span class="number">2</span>, half_angle)</span><br><span class="line">    <span class="keyword">if</span> half_angle == <span class="number">0</span>:</span><br><span class="line">        axis = torch.tensor([<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>])</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        axis = torch.div(torch.stack([x, y, z]), torch.sin(half_angle))</span><br><span class="line">    <span class="keyword">return</span> axis, angle</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">RegLoss</span>(<span class="params">planes, quaternions, *, device: torch.device</span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    正则化损失函数</span></span><br><span class="line"><span class="string">    @param planes: 预测的对称平面 3x4</span></span><br><span class="line"><span class="string">    @param quaternions: 预测的旋转轴 3x4</span></span><br><span class="line"><span class="string">    @param device: 设备</span></span><br><span class="line"><span class="string">    @return reg_loss: 正则化损失</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="comment"># 1. 计算对称平面法向量的单位向量</span></span><br><span class="line">    plane_normals = planes[:, :<span class="number">3</span>]</span><br><span class="line">    unit_plane_normals = F.normalize(plane_normals, p=<span class="number">2</span>, dim=<span class="number">1</span>)</span><br><span class="line">    <span class="comment"># 2. 计算旋转轴的单位向量</span></span><br><span class="line">    rotate_axes = []</span><br><span class="line">    <span class="keyword">for</span> quat <span class="keyword">in</span> quaternions:</span><br><span class="line">        axis, _ = quat2axisangle(quat)</span><br><span class="line">        rotate_axes.append(axis)</span><br><span class="line">    rotate_axes = torch.stack(rotate_axes)</span><br><span class="line">    unit_rotate_axes = F.normalize(rotate_axes, p=<span class="number">2</span>, dim=<span class="number">1</span>)</span><br><span class="line">    <span class="comment"># 3. 计算正交性损失</span></span><br><span class="line">    planes_matrixA = torch.sub(torch.matmul(unit_plane_normals, unit_plane_normals.transpose(<span class="number">0</span>, <span class="number">1</span>)), torch.eye(<span class="number">3</span>, device=device))</span><br><span class="line">    axes_matrixB = torch.sub(torch.matmul(unit_rotate_axes, unit_rotate_axes.transpose(<span class="number">0</span>, <span class="number">1</span>)), torch.eye(<span class="number">3</span>, device=device))</span><br><span class="line">    <span class="comment"># 4. 计算F2范数平方的和</span></span><br><span class="line">    reg_loss = torch.add(torch.<span class="built_in">sum</span>(torch.<span class="built_in">pow</span>(planes_matrixA, <span class="number">2</span>)), torch.<span class="built_in">sum</span>(torch.<span class="built_in">pow</span>(axes_matrixB, <span class="number">2</span>)))</span><br><span class="line">    <span class="keyword">return</span> reg_loss</span><br></pre></td></tr></table></figure>
<h1 id="4-cnn网络实现"><a class="markdownIt-Anchor" href="#4-cnn网络实现"></a> 4 CNN网络实现</h1>
<h2 id="41-网络结构"><a class="markdownIt-Anchor" href="#41-网络结构"></a> 4.1 网络结构</h2>
<img src="/2024/07/31/Code-PRS-Net/Network.png" class="" title="PRS-Net">
<ul>
<li>5个3D卷积层
<ul>
<li>卷积核大小（kernel size）为3</li>
<li>填充（padding）为1</li>
<li>步幅（stride）为1</li>
<li>每层后使用最大值池化（Max Pooling），卷积核大小为2</li>
<li>激活函数使用Leaky ReLU</li>
</ul>
</li>
<li>全连接层</li>
</ul>
<h2 id="42-代码实现"><a class="markdownIt-Anchor" href="#42-代码实现"></a> 4.2 代码实现</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">实现CNN网络结构：</span></span><br><span class="line"><span class="string">    - 5个3D卷积层</span></span><br><span class="line"><span class="string">        - 卷积核大小（kernel size）为3</span></span><br><span class="line"><span class="string">        - 填充（padding）为1</span></span><br><span class="line"><span class="string">        - 步幅（stride）为1</span></span><br><span class="line"><span class="string">        - 每层后使用最大值池化（Max Pooling），卷积核大小为2</span></span><br><span class="line"><span class="string">        - 激活函数使用Leaky ReLU</span></span><br><span class="line"><span class="string">    - 全连接层</span></span><br><span class="line"><span class="string">输入：</span></span><br><span class="line"><span class="string">    32x32x32像素的3D体素数据</span></span><br><span class="line"><span class="string">输出：</span></span><br><span class="line"><span class="string">    3个4参数隐式表示的对称平面，3个4参数轴角表示的旋转轴</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> torch.nn <span class="keyword">as</span> nn</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">PRS_Net</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">super</span>().__init__()</span><br><span class="line">        <span class="comment"># 5个3D卷积层配置</span></span><br><span class="line">        self.conv1 = nn.Sequential(nn.Conv3d(<span class="number">1</span>, <span class="number">4</span>, <span class="number">3</span>, padding=<span class="number">1</span>), nn.MaxPool3d(<span class="number">2</span>, <span class="number">2</span>), nn.LeakyReLU())</span><br><span class="line">        self.conv2 = nn.Sequential(nn.Conv3d(<span class="number">4</span>, <span class="number">8</span>, <span class="number">3</span>, padding=<span class="number">1</span>), nn.MaxPool3d(<span class="number">2</span>, <span class="number">2</span>), nn.LeakyReLU())</span><br><span class="line">        self.conv3 = nn.Sequential(nn.Conv3d(<span class="number">8</span>, <span class="number">16</span>, <span class="number">3</span>, padding=<span class="number">1</span>), nn.MaxPool3d(<span class="number">2</span>, <span class="number">2</span>), nn.LeakyReLU())</span><br><span class="line">        self.conv4 = nn.Sequential(nn.Conv3d(<span class="number">16</span>, <span class="number">32</span>, <span class="number">3</span>, padding=<span class="number">1</span>), nn.MaxPool3d(<span class="number">2</span>, <span class="number">2</span>), nn.LeakyReLU())</span><br><span class="line">        self.conv5 = nn.Sequential(nn.Conv3d(<span class="number">32</span>, <span class="number">64</span>, <span class="number">3</span>, padding=<span class="number">1</span>), nn.MaxPool3d(<span class="number">2</span>, <span class="number">2</span>), nn.LeakyReLU())</span><br><span class="line">        <span class="comment"># 全连接层配置</span></span><br><span class="line">        self.plane_seqs = nn.ModuleList([</span><br><span class="line">            nn.Sequential(nn.Linear(<span class="number">64</span>, <span class="number">32</span>), nn.LeakyReLU(), nn.Linear(<span class="number">32</span>, <span class="number">16</span>), nn.LeakyReLU(), nn.Linear(<span class="number">16</span>, <span class="number">4</span>)),</span><br><span class="line">            nn.Sequential(nn.Linear(<span class="number">64</span>, <span class="number">32</span>), nn.LeakyReLU(), nn.Linear(<span class="number">32</span>, <span class="number">16</span>), nn.LeakyReLU(), nn.Linear(<span class="number">16</span>, <span class="number">4</span>)),</span><br><span class="line">            nn.Sequential(nn.Linear(<span class="number">64</span>, <span class="number">32</span>), nn.LeakyReLU(), nn.Linear(<span class="number">32</span>, <span class="number">16</span>), nn.LeakyReLU(), nn.Linear(<span class="number">16</span>, <span class="number">4</span>))</span><br><span class="line">        ])</span><br><span class="line">        self.quat_seqs = nn.ModuleList([</span><br><span class="line">            nn.Sequential(nn.Linear(<span class="number">64</span>, <span class="number">32</span>), nn.LeakyReLU(), nn.Linear(<span class="number">32</span>, <span class="number">16</span>), nn.LeakyReLU(), nn.Linear(<span class="number">16</span>, <span class="number">4</span>)),</span><br><span class="line">            nn.Sequential(nn.Linear(<span class="number">64</span>, <span class="number">32</span>), nn.LeakyReLU(), nn.Linear(<span class="number">32</span>, <span class="number">16</span>), nn.LeakyReLU(), nn.Linear(<span class="number">16</span>, <span class="number">4</span>)),</span><br><span class="line">            nn.Sequential(nn.Linear(<span class="number">64</span>, <span class="number">32</span>), nn.LeakyReLU(), nn.Linear(<span class="number">32</span>, <span class="number">16</span>), nn.LeakyReLU(), nn.Linear(<span class="number">16</span>, <span class="number">4</span>))</span><br><span class="line">        ])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">conv_layers</span>(<span class="params">self, <span class="built_in">input</span></span>):</span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        5个3D卷积层实现</span></span><br><span class="line"><span class="string">        @param input: 输入数据[batch_size, 1, 32, 32, 32]</span></span><br><span class="line"><span class="string">        @return output: 输出数据[batch_size, 64, 1, 1, 1]</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span></span><br><span class="line">        x = self.conv1(<span class="built_in">input</span>)</span><br><span class="line">        x = self.conv2(x)</span><br><span class="line">        x = self.conv3(x)</span><br><span class="line">        x = self.conv4(x)</span><br><span class="line">        output = self.conv5(x)</span><br><span class="line">        <span class="keyword">return</span> output</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">full_connect</span>(<span class="params">self, <span class="built_in">input</span></span>):</span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        全连接层实现</span></span><br><span class="line"><span class="string">        @param input: 输入数据[batch_size, 64, 1, 1, 1]</span></span><br><span class="line"><span class="string">        @return planes: 3个4参数隐式表示的对称平面[batch_size, 3, 4]</span></span><br><span class="line"><span class="string">        @return quaternions: 3个4参数轴角表示的旋转轴[batch_size, 3, 4]</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span></span><br><span class="line">        planes = []</span><br><span class="line">        quaternions = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">            x = <span class="built_in">input</span>.view(<span class="built_in">input</span>.size(<span class="number">0</span>), -<span class="number">1</span>)</span><br><span class="line">            plane = self.plane_seqs[i](x)</span><br><span class="line">            quaternion = self.quat_seqs[i](x)</span><br><span class="line">            planes.append(plane)</span><br><span class="line">            quaternions.append(quaternion)</span><br><span class="line">        planes = torch.stack(planes, dim=<span class="number">1</span>)</span><br><span class="line">        quaternions = torch.stack(quaternions, dim=<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> planes, quaternions</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, <span class="built_in">input</span></span>):</span><br><span class="line">        <span class="comment"># 前向传播</span></span><br><span class="line">        x = self.conv_layers(<span class="built_in">input</span>)</span><br><span class="line">        output = self.full_connect(x)</span><br><span class="line">        <span class="keyword">return</span> output</span><br></pre></td></tr></table></figure>
<h1 id="5-训练与测试"><a class="markdownIt-Anchor" href="#5-训练与测试"></a> 5 训练与测试</h1>
<h2 id="51-配置文件"><a class="markdownIt-Anchor" href="#51-配置文件"></a> 5.1 配置文件</h2>
<p>将静态参数保存在配置文件<code>config.yml</code>中，方便调整参数</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">basic:</span></span><br><span class="line">  <span class="attr">dataset_path:</span> <span class="string">&#x27;./datasets/&#x27;</span></span><br><span class="line">  <span class="attr">save_path:</span> <span class="string">&#x27;./results/&#x27;</span></span><br><span class="line"><span class="attr">gpu:</span></span><br><span class="line">  <span class="attr">core_num:</span> <span class="number">1</span></span><br><span class="line"><span class="attr">hyperparameters:</span></span><br><span class="line">  <span class="attr">epochs:</span> <span class="number">5</span></span><br><span class="line">  <span class="attr">batch_size:</span> <span class="number">32</span></span><br><span class="line">  <span class="attr">learning_rate:</span> <span class="number">0.01</span></span><br><span class="line">  <span class="attr">reg_weight:</span> <span class="number">25</span></span><br><span class="line"><span class="attr">test:</span></span><br><span class="line">  <span class="attr">dihedral_angle_bound:</span> <span class="number">0.5235987756</span></span><br><span class="line">  <span class="attr">sde_bound:</span> <span class="number">4e-4</span></span><br></pre></td></tr></table></figure>
<h2 id="52-数据集准备"><a class="markdownIt-Anchor" href="#52-数据集准备"></a> 5.2 数据集准备</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">从mat文件中读取数据</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">import</span> scipy.io <span class="keyword">as</span> sio</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> torch.utils.data <span class="keyword">import</span> Dataset</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">parseMat</span>(<span class="params">mat_path</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    从mat文件中读取数据</span></span><br><span class="line"><span class="string">    :param mat_path: mat文件路径</span></span><br><span class="line"><span class="string">    :return: 数据</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    data = sio.loadmat(mat_path)</span><br><span class="line">    result = &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> key <span class="keyword">in</span> data.keys():</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;__&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> key:</span><br><span class="line">            result[key] = data[key]</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RawData</span>:</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    原始数据类</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, data</span>):</span><br><span class="line">        self.data = data</span><br><span class="line">        self.volumn = torch.tensor(data[<span class="string">&#x27;volumn&#x27;</span>], dtype=torch.float32)</span><br><span class="line">        self.vertices = torch.tensor(data[<span class="string">&#x27;volumn_vertices&#x27;</span>], dtype=torch.float32)</span><br><span class="line">        self.samples = torch.tensor(data[<span class="string">&#x27;volumn_samples&#x27;</span>], dtype=torch.float32)</span><br><span class="line">        self.faces = torch.tensor(data[<span class="string">&#x27;faces&#x27;</span>], dtype=torch.float32)</span><br><span class="line">        self.rotate_axisangle = torch.tensor(data[<span class="string">&#x27;rotate_axisangle&#x27;</span>], dtype=torch.float32)</span><br><span class="line">        self.voxel_centers = torch.tensor(data[<span class="string">&#x27;voxel_centers&#x27;</span>], dtype=torch.float32)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__getitem__</span>(<span class="params">self, key</span>):</span><br><span class="line">        <span class="keyword">return</span> self.data[key]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__setitem__</span>(<span class="params">self, key, value</span>):</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">volumn</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self.volumn</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">vertices</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self.vertices</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">samples</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self.samples</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">faces</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self.faces</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">rotate_axisangle</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self.rotate_axisangle</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">voxel_centers</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self.voxel_centers</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ShapeNetData</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    基于ShapeNet数据集的数据加载类</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, root_dir</span>):</span><br><span class="line">        self.root_dir = root_dir</span><br><span class="line">        self.dir_list = os.listdir(self.root_dir)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__len__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">len</span>(self.dir_list)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__getitem__</span>(<span class="params">self, idx</span>):</span><br><span class="line">        mat_path = os.path.join(self.root_dir, self.dir_list[idx])</span><br><span class="line">        data = parseMat(mat_path)</span><br><span class="line">        <span class="keyword">return</span> data</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ShapeNetDataset</span>(<span class="title class_ inherited__">Dataset</span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    体素模型的数据加载类</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, root_dir</span>):</span><br><span class="line">        self.data = ShapeNetData(root_dir)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__len__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">len</span>(self.data)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__getitem__</span>(<span class="params">self, idx</span>):</span><br><span class="line">        data = self.data[idx]</span><br><span class="line">        volumn = torch.tensor(data[<span class="string">&#x27;volumn&#x27;</span>], dtype=torch.float32)</span><br><span class="line">        volumn = volumn.expand(<span class="number">1</span>, <span class="number">32</span>, <span class="number">32</span>, <span class="number">32</span>)</span><br><span class="line">        <span class="keyword">return</span> volumn</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">raw_data</span>(<span class="params">self, idx</span>):</span><br><span class="line">        raw_data = self.data[idx]</span><br><span class="line">        <span class="keyword">return</span> RawData(raw_data)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="comment"># 模块测试代码</span></span><br><span class="line">    <span class="keyword">from</span> torch.utils.data <span class="keyword">import</span> DataLoader</span><br><span class="line">    root_dir = <span class="string">&#x27;./datasets/train/&#x27;</span></span><br><span class="line">    dataset = ShapeNetDataset(root_dir)</span><br><span class="line">    dataloader = DataLoader(dataset, batch_size=<span class="number">4</span>, shuffle=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">for</span> i, data <span class="keyword">in</span> <span class="built_in">enumerate</span>(dataloader):</span><br><span class="line">        <span class="built_in">print</span>(data.shape)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
<h2 id="53-训练"><a class="markdownIt-Anchor" href="#53-训练"></a> 5.3 训练</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> yaml</span><br><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> torch.optim <span class="keyword">as</span> optim</span><br><span class="line"><span class="keyword">from</span> torch.utils.data <span class="keyword">import</span> DataLoader</span><br><span class="line"><span class="keyword">from</span> utils.loss <span class="keyword">import</span> SumLoss</span><br><span class="line"><span class="keyword">from</span> utils.network <span class="keyword">import</span> PRS_Net</span><br><span class="line"><span class="keyword">from</span> utils.data <span class="keyword">import</span> ShapeNetDataset</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">train</span>():</span><br><span class="line">    <span class="comment"># 配置参数</span></span><br><span class="line">    device = torch.device(<span class="string">&#x27;cuda&#x27;</span> <span class="keyword">if</span> torch.cuda.is_available() <span class="keyword">else</span> <span class="string">&#x27;cpu&#x27;</span>)</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;./config.yml&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        config = yaml.load(f, Loader=yaml.FullLoader)</span><br><span class="line">    data_path = config[<span class="string">&#x27;basic&#x27;</span>][<span class="string">&#x27;dataset_path&#x27;</span>] + <span class="string">&#x27;train/&#x27;</span></span><br><span class="line">    save_path = config[<span class="string">&#x27;basic&#x27;</span>][<span class="string">&#x27;save_path&#x27;</span>]</span><br><span class="line">    <span class="comment"># 配置超参数</span></span><br><span class="line">    hyperparameters = config[<span class="string">&#x27;hyperparameters&#x27;</span>]</span><br><span class="line">    epochs = hyperparameters[<span class="string">&#x27;epochs&#x27;</span>]</span><br><span class="line">    batch_size = hyperparameters[<span class="string">&#x27;batch_size&#x27;</span>]</span><br><span class="line">    learning_rate = hyperparameters[<span class="string">&#x27;learning_rate&#x27;</span>]</span><br><span class="line">    reg_wight = hyperparameters[<span class="string">&#x27;reg_weight&#x27;</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 加载数据</span></span><br><span class="line">    dataset = ShapeNetDataset(data_path)</span><br><span class="line">    dataloader = DataLoader(dataset, batch_size=batch_size, shuffle=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 加载网络</span></span><br><span class="line">    net = PRS_Net().to(device)</span><br><span class="line">    optimizer = optim.Adam(net.parameters(), lr=learning_rate)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 训练</span></span><br><span class="line">    <span class="keyword">for</span> epoch <span class="keyword">in</span> <span class="built_in">range</span>(epochs):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;epoch: &#x27;</span>, epoch + <span class="number">1</span>)</span><br><span class="line">        running_loss = <span class="number">0.0</span></span><br><span class="line">        <span class="keyword">for</span> i, data <span class="keyword">in</span> <span class="built_in">enumerate</span>(dataloader):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;batch: &#x27;</span>, i + <span class="number">1</span>)</span><br><span class="line">            inputs = data.to(device)</span><br><span class="line">            optimizer.zero_grad()</span><br><span class="line">            planes_batch, quaternions_batch = net(inputs)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> batch <span class="keyword">in</span> <span class="built_in">range</span>(batch_size):</span><br><span class="line">                planes = planes_batch[batch].clone().detach().requires_grad_(<span class="literal">True</span>)</span><br><span class="line">                quaternions = quaternions_batch[batch].clone().detach().requires_grad_(<span class="literal">True</span>)</span><br><span class="line">                model_idx = i * batch_size + batch</span><br><span class="line">                samples = dataset.raw_data(model_idx).samples.to(device)</span><br><span class="line">                vertices = dataset.raw_data(model_idx).vertices.to(device)</span><br><span class="line">                loss = SumLoss(planes, quaternions, samples, vertices, reg_wight, device=device)</span><br><span class="line">                loss.backward()</span><br><span class="line">            optimizer.step()</span><br><span class="line">            running_loss += loss.item()</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;loss: &#x27;</span>, loss.item())</span><br><span class="line">            <span class="keyword">if</span> i % <span class="number">200</span> == <span class="number">199</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;%d-[%5d, %5d] avg_loss: %.3f&#x27;</span> % (epoch + <span class="number">1</span>, i - <span class="number">198</span>, i + <span class="number">1</span>, running_loss / <span class="number">200</span>))</span><br><span class="line">                running_loss = <span class="number">0.0</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Finished Training&#x27;</span>)</span><br><span class="line">    torch.save(net.state_dict(), save_path + <span class="string">&#x27;PRS-Net.pth&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    train()</span><br></pre></td></tr></table></figure>
<h2 id="54-测试"><a class="markdownIt-Anchor" href="#54-测试"></a> 5.4 测试</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> yaml</span><br><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">from</span> torch.utils.data <span class="keyword">import</span> DataLoader</span><br><span class="line"><span class="keyword">from</span> utils.data <span class="keyword">import</span> ShapeNetDataset</span><br><span class="line"><span class="keyword">from</span> utils.loss <span class="keyword">import</span> plane_sde_loss, quat_sde_loss</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test</span>():</span><br><span class="line">    <span class="comment"># 配置参数</span></span><br><span class="line">    device = torch.device(<span class="string">&#x27;cuda&#x27;</span> <span class="keyword">if</span> torch.cuda.is_available() <span class="keyword">else</span> <span class="string">&#x27;cpu&#x27;</span>)</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;./config.yml&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        config = yaml.load(f, Loader=yaml.FullLoader)</span><br><span class="line">    data_path = config[<span class="string">&#x27;basic&#x27;</span>][<span class="string">&#x27;dataset_path&#x27;</span>] + <span class="string">&#x27;test/&#x27;</span></span><br><span class="line">    save_path = config[<span class="string">&#x27;basic&#x27;</span>][<span class="string">&#x27;save_path&#x27;</span>]</span><br><span class="line">    sde_bound = config[<span class="string">&#x27;test&#x27;</span>][<span class="string">&#x27;sde_bound&#x27;</span>]</span><br><span class="line">    dihedral_angle_bound = config[<span class="string">&#x27;test&#x27;</span>][<span class="string">&#x27;dihedral_angle_bound&#x27;</span>]</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 加载模型</span></span><br><span class="line">    net = torch.load(save_path + <span class="string">&#x27;PRS-Net.pth&#x27;</span>).to(device)</span><br><span class="line">    net.<span class="built_in">eval</span>()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 加载数据</span></span><br><span class="line">    dataset = ShapeNetDataset(data_path)</span><br><span class="line">    dataloader = DataLoader(dataset, batch_size=<span class="number">1</span>, shuffle=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 测试</span></span><br><span class="line">    <span class="keyword">for</span> i, data <span class="keyword">in</span> <span class="built_in">enumerate</span>(dataloader):</span><br><span class="line">        inputs = data.to(device)</span><br><span class="line">        planes, quaternions = net(inputs)</span><br><span class="line">        samples = dataset.raw_data(i).samples.to(device)</span><br><span class="line">        vertices = dataset.raw_data(i).vertices.to(device)</span><br><span class="line">        planes, quaternions = check_invalid(planes, quaternions, samples, vertices, bound=sde_bound, device=device)</span><br><span class="line">        planes, quaternions = check_repeat(planes, quaternions, samples, vertices, bound=dihedral_angle_bound, device=device)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;planes:&#x27;</span>, planes, sep=<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;quaternions:&#x27;</span>, quaternions, sep=<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> i == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check_invalid</span>(<span class="params">planes, quaternions, samples, points, *, bound, device</span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    检查无效的对称平面和旋转轴</span></span><br><span class="line"><span class="string">    @param planes: 对称平面列表 3x4</span></span><br><span class="line"><span class="string">    @param quaternions: 旋转轴列表 3x4</span></span><br><span class="line"><span class="string">    @param samples: 采样点 3xM</span></span><br><span class="line"><span class="string">    @param points: 模型所有顶点 3xN</span></span><br><span class="line"><span class="string">    @param device: 设备</span></span><br><span class="line"><span class="string">    @return planes: 有效的对称平面列表</span></span><br><span class="line"><span class="string">    @return quaternions: 有效的旋转轴列表</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="comment"># 去除SDE大于阈值的对称平面和旋转轴</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(planes)):</span><br><span class="line">        <span class="keyword">if</span> plane_sde_loss(planes[i], samples, points, device=device) &gt; bound:</span><br><span class="line">            planes.pop(i)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(quaternions)):</span><br><span class="line">        <span class="keyword">if</span> quat_sde_loss(quaternions[i], samples, points, device=device) &gt; bound:</span><br><span class="line">            quaternions.pop(i)</span><br><span class="line">    <span class="keyword">return</span> planes, quaternions</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check_repeat</span>(<span class="params">planes, quaternions, samples, points, *, bound, device</span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    检查重复的对称平面和旋转轴</span></span><br><span class="line"><span class="string">    @param planes: 对称平面列表 3x4</span></span><br><span class="line"><span class="string">    @param quaternions: 旋转轴列表 3x4</span></span><br><span class="line"><span class="string">    @param device: 设备</span></span><br><span class="line"><span class="string">    @return planes: 去重后的对称平面列表</span></span><br><span class="line"><span class="string">    @return quaternions: 去重后的旋转轴列表</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="comment"># 两个法向量的夹角小于阈值则认为是同一个平面，去除SDE较大的平面</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(planes)):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i + <span class="number">1</span>, <span class="built_in">len</span>(planes)):</span><br><span class="line">            <span class="keyword">if</span> dihedral_angle(planes[i], planes[j]) &lt; bound:</span><br><span class="line">                <span class="keyword">if</span> plane_sde_loss(planes[i], samples, points, device=device) &lt; plane_sde_loss(planes[j], samples, points, device=device):</span><br><span class="line">                    planes.pop(j)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    planes.pop(i)</span><br><span class="line">    <span class="comment"># 两个旋转轴的夹角小于阈值则认为是同一个旋转轴，去除SDE较大的旋转轴</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(quaternions)):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i + <span class="number">1</span>, <span class="built_in">len</span>(quaternions)):</span><br><span class="line">            <span class="keyword">if</span> dihedral_angle(quaternions[i], quaternions[j]) &lt; bound:</span><br><span class="line">                <span class="keyword">if</span> quat_sde_loss(quaternions[i], samples, points, device=device) &lt; quat_sde_loss(quaternions[j], samples, points, device=device):</span><br><span class="line">                    quaternions.pop(j)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    quaternions.pop(i)</span><br><span class="line">    <span class="keyword">return</span> planes, quaternions</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dihedral_angle</span>(<span class="params">v1, v2</span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    计算两个向量的二面角</span></span><br><span class="line"><span class="string">    @param v1: 向量1 1x3</span></span><br><span class="line"><span class="string">    @param v2: 向量2 1x3</span></span><br><span class="line"><span class="string">    @return angle: 二面角</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    angle = torch.acos(torch.dot(v1, v2) / (torch.norm(v1) * torch.norm(v2)))</span><br><span class="line">    <span class="keyword">return</span> angle</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    test()</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://a-cs99.github.io/2024/07/14/Voxelization/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Jiaming He">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ACS99的个人博客">
      <meta itemprop="description" content="分享个人学习与实战经历">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | ACS99的个人博客">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/07/14/Voxelization/" class="post-title-link" itemprop="url">PRS-Net中OBJ格式的体素化处理</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-07-14 23:25:15" itemprop="dateCreated datePublished" datetime="2024-07-14T23:25:15+08:00">2024-07-14</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-07-31 15:21:34" itemprop="dateModified" datetime="2024-07-31T15:21:34+08:00">2024-07-31</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E8%AE%BA%E6%96%87%E5%A4%8D%E7%8E%B0/" itemprop="url" rel="index"><span itemprop="name">论文复现</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E8%AE%BA%E6%96%87%E5%A4%8D%E7%8E%B0/MATLAB%E7%A8%8B%E5%BA%8F/" itemprop="url" rel="index"><span itemprop="name">MATLAB程序</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E8%AE%BA%E6%96%87%E5%A4%8D%E7%8E%B0/MATLAB%E7%A8%8B%E5%BA%8F/%E4%B8%89%E7%BB%B4%E5%9B%BE%E5%BD%A2%E5%AD%A6/" itemprop="url" rel="index"><span itemprop="name">三维图形学</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <blockquote>
<p>论文原文：<a target="_blank" rel="noopener" href="https://arxiv.org/abs/1910.06511v6">PRS-Net: Planar Reflective Symmetry Detection Network</a></p>
</blockquote>
<h1 id="1-本文目的"><a class="markdownIt-Anchor" href="#1-本文目的"></a> 1 本文目的</h1>
<p>探讨如何使用MATLAB将OBJ格式的三维模型体素化，以便于PRS-Net的输入</p>
<h1 id="2-数据集及环境"><a class="markdownIt-Anchor" href="#2-数据集及环境"></a> 2 数据集及环境</h1>
<ul>
<li>ShapeNetCore.v2中的模型（OBJ格式，基于数据量需要对基础模型进行旋转变换）</li>
<li>MATLAB R2022a</li>
</ul>
<h1 id="3-体素化效果"><a class="markdownIt-Anchor" href="#3-体素化效果"></a> 3 体素化效果</h1>
<p>体素化前后的模型对比如下：</p>
<ul>
<li>未体素化的模型：</li>
</ul>
  <img src="/2024/07/14/Voxelization/raw_model.png" class="" width="440" height="330" title="体素化前">
<ul>
<li>体素化后的模型：</li>
</ul>
  <img src="/2024/07/14/Voxelization/eg_volumn.png" class="" width="440" height="330" title="体素化后">
<h1 id="4-实现思路"><a class="markdownIt-Anchor" href="#4-实现思路"></a> 4 实现思路</h1>
<blockquote>
<p>将三维模型转换为三维体素网格</p>
</blockquote>
<h2 id="41-读取obj文件"><a class="markdownIt-Anchor" href="#41-读取obj文件"></a> 4.1 读取OBJ文件</h2>
<p>使用readOBJ函数读取OBJ文件，获取模型的顶点和三角面信息（体素化使用）</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">% 读取obj文件的顶点和三角面</span></span><br><span class="line"><span class="comment">% % vertices中元素为点坐标：[x,y,z]</span></span><br><span class="line"><span class="comment">% % faces中元素为面的三个点序号: [v1,v2,v3]</span></span><br><span class="line">[vertices, faces, ~] = readOBJ(obj_path);</span><br></pre></td></tr></table></figure>
<p>同时使用meshlpsampling函数从OBJ表面随机选取一定数量的点作为采样点（无监督训练时计算误差使用）</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">% 从obj表面随机选取sample_num个点</span></span><br><span class="line"><span class="comment">% % surf_samples中元素为点坐标: [x,y,z]</span></span><br><span class="line">[surf_samples, ~] = meshlpsampling(obj_path, sample_num);</span><br></pre></td></tr></table></figure>
<h2 id="42-旋转变换增加模型数量"><a class="markdownIt-Anchor" href="#42-旋转变换增加模型数量"></a> 4.2 旋转变换增加模型数量</h2>
<p>为了增加数据集的多样性，对基础模型进行旋转变换，生成更多的模型<br />
配置每个种类的目标模型数，从而计算平均到每个模型所需的模型变种数</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">% 配置每个种类的目标模型数 (数量不足时对原模型做变换)</span></span><br><span class="line">models_need = <span class="number">4000</span>;</span><br><span class="line"><span class="comment">% ...</span></span><br><span class="line"><span class="comment">% 计算平均到每个模型所需的模型变种数</span></span><br><span class="line">models_need_each = <span class="built_in">ceil</span>(models_need / <span class="built_in">length</span>(model_ids));</span><br></pre></td></tr></table></figure>
<p>对每个模型的顶点进行旋转变换，生成更多的模型</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">% 生成随机的规范化旋转轴</span></span><br><span class="line">axis = <span class="built_in">rand</span>(<span class="number">1</span>,<span class="number">3</span>);</span><br><span class="line">axis = axis/norm(axis);</span><br><span class="line"><span class="comment">% 生成随机的旋转角度</span></span><br><span class="line"><span class="built_in">angle</span> = <span class="built_in">rand</span>(<span class="number">1</span>)*<span class="number">2</span>*<span class="built_in">pi</span>;</span><br><span class="line"><span class="comment">% 合成轴角表示</span></span><br><span class="line">rotate_axisangle = [axis, <span class="built_in">angle</span>];</span><br><span class="line"><span class="comment">% 生成旋转矩阵</span></span><br><span class="line">rotate_matrix = axang2rotm(rotate_axisangle);</span><br><span class="line"><span class="comment">% 旋转所有顶点 (三角面只和顶点序号相关，无需变换)</span></span><br><span class="line"><span class="comment">% % 取顶点矩阵的转置，以和旋转矩阵相乘</span></span><br><span class="line">r_vertices = rotate_matrix*vertices&#x27;;</span><br><span class="line">r_surf_samples = rotate_matrix*surf_samples;</span><br></pre></td></tr></table></figure>
<h2 id="43-顶点坐标对应到体素坐标"><a class="markdownIt-Anchor" href="#43-顶点坐标对应到体素坐标"></a> 4.3 顶点坐标对应到体素坐标</h2>
<p>OBJ原始模型的顶点坐标是规范化的，坐标值在[-0.5,0.5]之间<br />
需要将其转换到体素坐标系，使得坐标值在[0,volumn_size]之间</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">% 将顶点的规范化坐标系平移缩放到体素对应的位置</span></span><br><span class="line">volumn_vertices = volumn_size*(r_vertices + <span class="number">0.5</span>) + <span class="number">0.5</span>;</span><br><span class="line">volumn_samples = volumn_size*(r_surf_samples + <span class="number">0.5</span>) + <span class="number">0.5</span>;</span><br></pre></td></tr></table></figure>
<h2 id="44-将三角面的索引形式转换为顶点坐标"><a class="markdownIt-Anchor" href="#44-将三角面的索引形式转换为顶点坐标"></a> 4.4 将三角面的索引形式转换为顶点坐标</h2>
<p>OBJ模型的三角面是由三个顶点的索引组成的，将其转换为顶点坐标以便后续体素化处理</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">volumn</span> = <span class="title">model2volumn</span><span class="params">(model,volumn_size)</span></span></span><br><span class="line">    <span class="comment">% volumn_size必须为整数</span></span><br><span class="line">    volumn_size = <span class="built_in">round</span>(volumn_size);</span><br><span class="line">    volumn_size = [volumn_size, volumn_size, volumn_size];</span><br><span class="line">    <span class="comment">% 按列划分顶点和三角面</span></span><br><span class="line">    vertices = struct();</span><br><span class="line">    vertices.x = double(model.vertices(<span class="number">1</span>,:));</span><br><span class="line">    vertices.y = double(model.vertices(<span class="number">2</span>,:));</span><br><span class="line">    vertices.z = double(model.vertices(<span class="number">3</span>,:));</span><br><span class="line"></span><br><span class="line">    faces = struct();</span><br><span class="line">    faces.v1 = double(model.faces(:,<span class="number">1</span>));</span><br><span class="line">    faces.v2 = double(model.faces(:,<span class="number">2</span>));</span><br><span class="line">    faces.v3 = double(model.faces(:,<span class="number">3</span>));</span><br><span class="line"></span><br><span class="line">    <span class="comment">% 得到double类型的顶点和三角面的顶点坐标</span></span><br><span class="line">    <span class="comment">% % double_vertices为N×3的矩阵</span></span><br><span class="line">    <span class="comment">% % face_vertices为结构体&#123;&#x27;v1&#x27;: N×3, &#x27;v2&#x27;: N×3, &#x27;v3&#x27;: N×3&#125;</span></span><br><span class="line">    <span class="comment">% % 上述N×3矩阵结构相同，每行为点坐标[x,y,z]</span></span><br><span class="line">    double_vertices = [vertices.x&#x27;,vertices.y&#x27;,vertices.z&#x27;];</span><br><span class="line">    face_vertices = struct();</span><br><span class="line">    face_vertices.v1 = double_vertices(faces.v1,:);</span><br><span class="line">    face_vertices.v2 = double_vertices(faces.v2,:);</span><br><span class="line">    face_vertices.v3 = double_vertices(faces.v3,:);</span><br><span class="line"></span><br><span class="line">    <span class="comment">% 将volumn_size转换为double，以便处理</span></span><br><span class="line">    volumn_size = double(volumn_size);</span><br><span class="line">    <span class="comment">% 体素化处理</span></span><br><span class="line">    volumn = process_model(face_vertices, volumn_size);</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<h2 id="45-细分三角面"><a class="markdownIt-Anchor" href="#45-细分三角面"></a> 4.5 细分三角面</h2>
<p>将三角面细分为更小的三角面，使得每个三角面的边长不超过0.5个体素<br />
从而得到足够精细的体素化模型</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">face_vertices_splited</span> = <span class="title">split_faces</span><span class="params">(face_vertices)</span></span></span><br><span class="line">    splited_faces = struct(<span class="string">&#x27;v1&#x27;</span>,[],<span class="string">&#x27;v2&#x27;</span>,[],<span class="string">&#x27;v3&#x27;</span>,[]);</span><br><span class="line">    <span class="keyword">while</span>(~<span class="built_in">isempty</span>(face_vertices.v1))</span><br><span class="line">        <span class="built_in">disp</span>([<span class="string">&#x27;remain faces: &#x27;</span>, num2str(<span class="built_in">length</span>(face_vertices.v1))]);</span><br><span class="line">        <span class="comment">% 距离矩阵dist，每列分别代表一个边距离[(v1-v2),(v2-v3),(v1-v3)]，初始化为全零矩阵</span></span><br><span class="line">        dist = <span class="built_in">zeros</span>(<span class="built_in">length</span>(face_vertices.v1(:,<span class="number">1</span>)),<span class="number">3</span>);</span><br><span class="line">        <span class="comment">% 分别计算x^2，y^2，z^2并求和，得到距离</span></span><br><span class="line">        <span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:<span class="number">3</span></span><br><span class="line">            dist(:,<span class="number">1</span>) = dist(:,<span class="number">1</span>) + (face_vertices.v1(:,<span class="built_in">i</span>)-face_vertices.v2(:,<span class="built_in">i</span>)).^<span class="number">2</span>;</span><br><span class="line">            dist(:,<span class="number">2</span>) = dist(:,<span class="number">2</span>) + (face_vertices.v2(:,<span class="built_in">i</span>)-face_vertices.v3(:,<span class="built_in">i</span>)).^<span class="number">2</span>;</span><br><span class="line">            dist(:,<span class="number">3</span>) = dist(:,<span class="number">3</span>) + (face_vertices.v1(:,<span class="built_in">i</span>)-face_vertices.v3(:,<span class="built_in">i</span>)).^<span class="number">2</span>;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="comment">% 得到三边最大值，构成列向量</span></span><br><span class="line">        maxdist = <span class="built_in">max</span>(dist,[],<span class="number">2</span>);</span><br><span class="line">        <span class="comment">% 得到最大边长大于0.5个体素的三角面，在can_split列向量对应行标记为1</span></span><br><span class="line">        can_split = maxdist &gt; <span class="number">0.5</span>;</span><br><span class="line">        splited_faces.v1 = [splited_faces.v1;face_vertices.v1(~can_split,:)];</span><br><span class="line">        splited_faces.v2 = face_vertices.v2(~can_split,:);</span><br><span class="line">        splited_faces.v3 = face_vertices.v3(~can_split,:);</span><br><span class="line">        <span class="comment">% 更新face_vertices和dist，去除无法再分割的三角面</span></span><br><span class="line">        face_vertices_temp = face_vertices;</span><br><span class="line">        face_vertices_temp.v1 = face_vertices.v1(can_split,:);</span><br><span class="line">        face_vertices_temp.v2 = face_vertices.v2(can_split,:);</span><br><span class="line">        face_vertices_temp.v3 = face_vertices.v3(can_split,:);</span><br><span class="line">        face_vertices = face_vertices_temp;</span><br><span class="line">        dist = dist(can_split,:);</span><br><span class="line">        <span class="comment">% 计算仍能分割的三角面的三边中点</span></span><br><span class="line">        mid_vertices = struct();</span><br><span class="line">        <span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:<span class="number">3</span></span><br><span class="line">            mid_vertices.v12(:,<span class="built_in">i</span>) = (face_vertices.v1(:,<span class="built_in">i</span>)+face_vertices.v2(:,<span class="built_in">i</span>))/<span class="number">2</span>;</span><br><span class="line">            mid_vertices.v23(:,<span class="built_in">i</span>) = (face_vertices.v2(:,<span class="built_in">i</span>)+face_vertices.v3(:,<span class="built_in">i</span>))/<span class="number">2</span>;</span><br><span class="line">            mid_vertices.v13(:,<span class="built_in">i</span>) = (face_vertices.v1(:,<span class="built_in">i</span>)+face_vertices.v3(:,<span class="built_in">i</span>))/<span class="number">2</span>;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="comment">% 计算得到各边最长的三角面</span></span><br><span class="line">        max_v12 = [dist(:,<span class="number">1</span>) &gt;= dist(:,<span class="number">2</span>) &amp; dist(:,<span class="number">1</span>) &gt;= dist(:,<span class="number">3</span>)];</span><br><span class="line">        max_v23 = [dist(:,<span class="number">2</span>) &gt;= dist(:,<span class="number">1</span>) &amp; dist(:,<span class="number">2</span>) &gt;= dist(:,<span class="number">3</span>) &amp; ~max_v12];</span><br><span class="line">        max_v13 = [dist(:,<span class="number">3</span>) &gt;= dist(:,<span class="number">1</span>) &amp; dist(:,<span class="number">3</span>) &gt;= dist(:,<span class="number">2</span>) &amp; ~max_v12 &amp; ~max_v23];</span><br><span class="line">        <span class="comment">% 左替换最长边结点为中点</span></span><br><span class="line">        left_split = face_vertices;</span><br><span class="line">        left_split.v1(max_v12,:) = mid_vertices.v12(max_v12,:);</span><br><span class="line">        left_split.v2(max_v23,:) = mid_vertices.v23(max_v23,:);</span><br><span class="line">        left_split.v1(max_v13,:) = mid_vertices.v13(max_v13,:);</span><br><span class="line">        <span class="comment">% 右替换最长边结点为中点</span></span><br><span class="line">        right_split = face_vertices;</span><br><span class="line">        right_split.v2(max_v12,:) = mid_vertices.v12(max_v12,:);</span><br><span class="line">        right_split.v3(max_v23,:) = mid_vertices.v23(max_v23,:);</span><br><span class="line">        right_split.v3(max_v13,:) = mid_vertices.v13(max_v13,:);</span><br><span class="line">        <span class="comment">% 拼接左右替换</span></span><br><span class="line">        face_vertices.v1 = [left_split.v1;right_split.v1];</span><br><span class="line">        face_vertices.v2 = [left_split.v2;right_split.v2];</span><br><span class="line">        face_vertices.v3 = [left_split.v3;right_split.v3];</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    face_vertices_splited = splited_faces;</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<h2 id="46-根据细分后的顶点坐标生成体素"><a class="markdownIt-Anchor" href="#46-根据细分后的顶点坐标生成体素"></a> 4.6 根据细分后的顶点坐标生成体素</h2>
<p>根据细分后的顶点坐标生成体素，将体素坐标转换为线性索引（提高性能）<br />
从而赋值给体素矩阵，得到体素化后的模型</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">volumn</span> = <span class="title">process_model</span><span class="params">(face_vertices, volumn_size)</span></span></span><br><span class="line">    <span class="comment">% 生成空体素</span></span><br><span class="line">    volumn = <span class="built_in">false</span>(volumn_size);</span><br><span class="line">    <span class="comment">% 细分三角面</span></span><br><span class="line">    face_vertices_splited = split_faces(face_vertices);</span><br><span class="line">    <span class="comment">% 拼接顶点坐标矩阵，并去除重复行</span></span><br><span class="line">    splited_vertices = [face_vertices_splited.v1;face_vertices_splited.v2;face_vertices_splited.v3];</span><br><span class="line">    splited_vertices = unique(splited_vertices, <span class="string">&#x27;rows&#x27;</span>, <span class="string">&#x27;stable&#x27;</span>);</span><br><span class="line">    <span class="comment">% 得到点坐标对应的体素坐标</span></span><br><span class="line">    voxel_vertices = [<span class="built_in">floor</span>(splited_vertices(:,<span class="number">1</span>))+<span class="number">1</span>,<span class="built_in">floor</span>(splited_vertices(:,<span class="number">2</span>))+<span class="number">1</span>,<span class="built_in">floor</span>(splited_vertices(:,<span class="number">3</span>))+<span class="number">1</span>];</span><br><span class="line">    voxel_vertices = unique(voxel_vertices, <span class="string">&#x27;rows&#x27;</span>, <span class="string">&#x27;stable&#x27;</span>);</span><br><span class="line">    <span class="comment">% 分别对 voxel_vertices 的每一列应用边界限制</span></span><br><span class="line">    voxel_vertices(:,<span class="number">1</span>) = <span class="built_in">max</span>(<span class="built_in">min</span>(voxel_vertices(:,<span class="number">1</span>), volumn_size(<span class="number">1</span>)), <span class="number">1</span>);</span><br><span class="line">    voxel_vertices(:,<span class="number">2</span>) = <span class="built_in">max</span>(<span class="built_in">min</span>(voxel_vertices(:,<span class="number">2</span>), volumn_size(<span class="number">2</span>)), <span class="number">1</span>);</span><br><span class="line">    voxel_vertices(:,<span class="number">3</span>) = <span class="built_in">max</span>(<span class="built_in">min</span>(voxel_vertices(:,<span class="number">3</span>), volumn_size(<span class="number">3</span>)), <span class="number">1</span>);</span><br><span class="line">    <span class="comment">% 将向量转换为线性索引，利用索引为对应体素位赋值</span></span><br><span class="line">    linear_indices = <span class="built_in">sub2ind</span>(<span class="built_in">size</span>(volumn), voxel_vertices(:,<span class="number">1</span>), voxel_vertices(:,<span class="number">2</span>), voxel_vertices(:,<span class="number">3</span>));</span><br><span class="line">    volumn(linear_indices) = <span class="built_in">true</span>;</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<h2 id="47-保存体素化结果"><a class="markdownIt-Anchor" href="#47-保存体素化结果"></a> 4.7 保存体素化结果</h2>
<p>得到体素化后的模型，可以将其保存为MAT文件，以便PRS-Net的输入</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">% 将顶点和三角面组合为结构体</span></span><br><span class="line">model = struct();</span><br><span class="line">model.vertices = volumn_vertices;</span><br><span class="line">model.faces = faces;</span><br><span class="line">volumn = model2volumn(model, volumn_size);</span><br><span class="line"><span class="comment">% 将所需变量保存</span></span><br><span class="line">save_name = [save_path, <span class="string">&#x27;/&#x27;</span>, model_ids&#123;<span class="built_in">j</span>&#125;, <span class="string">&#x27;_r&#x27;</span>, num2str(k), <span class="string">&#x27;.mat&#x27;</span>];</span><br><span class="line">save(save_name, <span class="string">&quot;volumn&quot;</span>, <span class="string">&quot;volumn_vertices&quot;</span>, <span class="string">&quot;volumn_samples&quot;</span>, <span class="string">&quot;faces&quot;</span>, <span class="string">&quot;rotate_axisangle&quot;</span>, <span class="string">&quot;voxel_centers&quot;</span>);</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://a-cs99.github.io/2024/07/06/PRS-Net/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Jiaming He">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ACS99的个人博客">
      <meta itemprop="description" content="分享个人学习与实战经历">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | ACS99的个人博客">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2024/07/06/PRS-Net/" class="post-title-link" itemprop="url">PRS-Net笔记</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-07-06 14:14:01" itemprop="dateCreated datePublished" datetime="2024-07-06T14:14:01+08:00">2024-07-06</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-07-14 23:28:14" itemprop="dateModified" datetime="2024-07-14T23:28:14+08:00">2024-07-14</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E8%AE%BA%E6%96%87%E5%A4%8D%E7%8E%B0/" itemprop="url" rel="index"><span itemprop="name">论文复现</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <blockquote>
<p>论文原文：<a target="_blank" rel="noopener" href="https://arxiv.org/abs/1910.06511v6">PRS-Net: Planar Reflective Symmetry Detection Network</a></p>
</blockquote>
<h1 id="1-导论"><a class="markdownIt-Anchor" href="#1-导论"></a> 1 导论</h1>
<p><strong>平面反射对称（Planar Reflective Symmetry，PRS）</strong> 是最常见、最重要的对称类型</p>
<h2 id="11-过去的方法"><a class="markdownIt-Anchor" href="#11-过去的方法"></a> 1.1 过去的方法</h2>
<ul>
<li><strong>主成分分析法（Principal Component Analysis，PCA）</strong>
<ul>
<li>适用于简单情况</li>
<li>无法处理不与任何主轴正交的对称平面</li>
<li>对微小的几何变化也十分敏感</li>
</ul>
</li>
<li><strong>空间采样方法（Spatial Sampling）</strong>
<ul>
<li>比PCA更鲁棒（robust）</li>
<li>必须对潜在目标进行采样</li>
<li>结果依赖采样的随机性</li>
</ul>
</li>
<li>各种<strong>需要监督的神经网络方法</strong>
<ul>
<li>当前没有无监督方法能够检测对称平面</li>
</ul>
</li>
</ul>
<h2 id="12-本文的方法"><a class="markdownIt-Anchor" href="#12-本文的方法"></a> 1.2 本文的方法</h2>
<h3 id="121-基本模型"><a class="markdownIt-Anchor" href="#121-基本模型"></a> 1.2.1 基本模型</h3>
<p><strong>无监督的深度卷积神经网络（Unsupervised Deep CNN，Convolutional Neural Network）</strong></p>
<ul>
<li>
<p>确定全局模型特征，自动检测全局平面反射对称</p>
</li>
<li>
<p>输入：体素化的形状模型</p>
</li>
<li>
<p>输出：反射面（reflection planes）和旋转轴（rotation axes）</p>
</li>
</ul>
<h3 id="122-损失函数"><a class="markdownIt-Anchor" href="#122-损失函数"></a> 1.2.2 损失函数</h3>
<ul>
<li>新型<strong>对称距离损失（Symmetry Distance Loss）</strong>
<ul>
<li>测量给定潜在对称平面的几何与对称的偏离</li>
</ul>
</li>
<li><strong>规范化损失（Regularization Loss）</strong>
<ul>
<li>避免生成重复的对称平面</li>
</ul>
</li>
</ul>
<h2 id="13-本文方法的优势"><a class="markdownIt-Anchor" href="#13-本文方法的优势"></a> 1.3 本文方法的优势</h2>
<ul>
<li>检测结果更加可信、更加准确</li>
<li>比传统方法快数百倍，可达到实时性能</li>
<li>对噪声和错误输入更加鲁棒</li>
</ul>
<h1 id="2-相关工作"><a class="markdownIt-Anchor" href="#2-相关工作"></a> 2 相关工作</h1>
<blockquote>
<p>本文主要关注对PRSNet的理解，此处略过对称检测领域相关工作的介绍</p>
</blockquote>
<h1 id="3-网络架构"><a class="markdownIt-Anchor" href="#3-网络架构"></a> 3 网络架构</h1>
<img src="/2024/07/06/PRS-Net/Network.png" class="" title="PRS-Net">
<h2 id="31-cnn网络整体结构"><a class="markdownIt-Anchor" href="#31-cnn网络整体结构"></a> 3.1 CNN网络整体结构</h2>
<ul>
<li>5个3D卷积层
<ul>
<li>卷积核大小（kernel size）为3</li>
<li>填充（padding）为1</li>
<li>步幅（stride）为1</li>
<li>每层后使用最大值池化（Max Pooling），卷积核大小为2</li>
<li>激活函数使用Leaky ReLU</li>
</ul>
</li>
<li>全连接层</li>
</ul>
<h2 id="32-输入层"><a class="markdownIt-Anchor" href="#32-输入层"></a> 3.2 输入层</h2>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>32</mn><mo>×</mo><mn>32</mn><mo>×</mo><mn>32</mn></mrow><annotation encoding="application/x-tex">32\times32\times32</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">3</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">3</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">3</span><span class="mord">2</span></span></span></span>的体素（由对称形状体素化得到）</p>
<h2 id="33-输出层"><a class="markdownIt-Anchor" href="#33-输出层"></a> 3.3 输出层</h2>
<p>无监督学习，输出根据损失函数自动优化</p>
<ul>
<li>三个对称平面的参数
<ul>
<li>隐式表示（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">P</mi><mi mathvariant="bold">i</mi></msub><mo>=</mo><mo stretchy="false">(</mo><msub><mover accent="true"><mi>n</mi><mo>⃗</mo></mover><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>d</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><mspace width="1em"/><msubsup><mover accent="true"><mi>n</mi><mo>⃗</mo></mover><mi>i</mi><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msubsup><mi>x</mi><mo>+</mo><msubsup><mover accent="true"><mi>n</mi><mo>⃗</mo></mover><mi>i</mi><mrow><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></msubsup><mi>y</mi><mo>+</mo><msubsup><mover accent="true"><mi>n</mi><mo>⃗</mo></mover><mi>i</mi><mrow><mo stretchy="false">(</mo><mn>3</mn><mo stretchy="false">)</mo></mrow></msubsup><mi>z</mi><mo>+</mo><msub><mi>d</mi><mi>i</mi></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\bold{P_i}=(\vec{n}_i,d_i),\quad\vec{n}_i^{(1)}x+\vec{n}_i^{(2)}y+\vec{n}_i^{(3)}z+d_i=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83611em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.321664em;vertical-align:-0.27686399999999994em;"></span><span class="mopen">(</span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2355em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2355em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.4231360000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.27686399999999994em;"><span></span></span></span></span></span></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.321664em;vertical-align:-0.27686399999999994em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2355em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.4231360000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">2</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.27686399999999994em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.321664em;vertical-align:-0.27686399999999994em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2355em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.4231360000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">3</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.27686399999999994em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span>）</li>
<li>法向量初始化为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>n</mi><mo>⃗</mo></mover><mn>1</mn></msub><mo>=</mo><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mn>0</mn><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo><mo separator="true">,</mo><msub><mover accent="true"><mi>n</mi><mo>⃗</mo></mover><mn>2</mn></msub><mo>=</mo><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo><mo separator="true">,</mo><msub><mover accent="true"><mi>n</mi><mo>⃗</mo></mover><mn>3</mn></msub><mo>=</mo><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\vec{n}_1=(1,0,0),\vec{n}_2=(0,1,0),\vec{n}_3=(0,0,1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.864em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2355em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2355em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2355em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></li>
</ul>
</li>
<li>三个对称轴的参数
<ul>
<li>训练过程中用四元数（quaternion）表示，训练完成转换为轴角表示</li>
<li>四元数表示<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">R</mi><mi mathvariant="bold">i</mi></msub><mo>=</mo><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mi>θ</mi><mi mathvariant="normal">/</mi><mn>2</mn><mo stretchy="false">)</mo><mo>+</mo><mi>s</mi><mi>i</mi><mi>n</mi><mo stretchy="false">(</mo><mi>θ</mi><mi mathvariant="normal">/</mi><mn>2</mn><mo stretchy="false">)</mo><mo stretchy="false">(</mo><msubsup><mover accent="true"><mi>v</mi><mo>⃗</mo></mover><mi>i</mi><mrow><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msubsup><mi mathvariant="bold">i</mi><mo>+</mo><msubsup><mover accent="true"><mi>v</mi><mo>⃗</mo></mover><mi>i</mi><mrow><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></msubsup><mi mathvariant="bold">j</mi><mo>+</mo><msubsup><mover accent="true"><mi>v</mi><mo>⃗</mo></mover><mi>i</mi><mrow><mo stretchy="false">(</mo><mn>3</mn><mo stretchy="false">)</mo></mrow></msubsup><mi mathvariant="bold">k</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\bold{R_i}=cos(\theta/2)+sin(\theta/2)(\vec{v}_i^{(1)}\bold i+\vec{v}_i^{(2)}\bold j+\vec{v}_i^{(3)}\bold k)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83611em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">o</span><span class="mord mathnormal">s</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mord">/</span><span class="mord">2</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.321664em;vertical-align:-0.27686399999999994em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal">n</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mord">/</span><span class="mord">2</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.20772em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.4231360000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.27686399999999994em;"><span></span></span></span></span></span></span><span class="mord mathbf">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.321664em;vertical-align:-0.27686399999999994em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.20772em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.4231360000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">2</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.27686399999999994em;"><span></span></span></span></span></span></span><span class="mord mathbf">j</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.321664em;vertical-align:-0.27686399999999994em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.20772em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.4231360000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">3</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.27686399999999994em;"><span></span></span></span></span></span></span><span class="mord mathbf">k</span><span class="mclose">)</span></span></span></span></li>
<li>旋转轴初始化为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>v</mi><mo>⃗</mo></mover><mn>1</mn></msub><mo>=</mo><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mn>0</mn><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo><mo separator="true">,</mo><msub><mover accent="true"><mi>v</mi><mo>⃗</mo></mover><mn>2</mn></msub><mo>=</mo><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo><mo separator="true">,</mo><msub><mover accent="true"><mi>v</mi><mo>⃗</mo></mover><mn>3</mn></msub><mo>=</mo><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\vec{v}_1=(1,0,0),\vec{v}_2=(0,1,0),\vec{v}_3=(0,0,1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.864em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.20772em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.20772em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.20772em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></li>
<li>旋转角度初始化为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi><mo>=</mo><mi>π</mi></mrow><annotation encoding="application/x-tex">\theta=\pi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span></span></span></span></li>
</ul>
</li>
</ul>
<h1 id="4-损失函数"><a class="markdownIt-Anchor" href="#4-损失函数"></a> 4 损失函数</h1>
<h2 id="41-对称距离损失symmetry-distance-loss"><a class="markdownIt-Anchor" href="#41-对称距离损失symmetry-distance-loss"></a> 4.1 对称距离损失（Symmetry Distance Loss）</h2>
<p>惩罚对称距离较远（即对称后偏离较大）的对称面/旋转轴</p>
<ul>
<li>第一步：从输入形状<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi></mrow><annotation encoding="application/x-tex">O</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span></span></span></span>上选取<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span>个样本点构成点集<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">Q</span></span></span></span>，基于这个点集进行后续计算</li>
<li>第二步：计算点集<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">Q</span></span></span></span>上任意一点<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">q</mi><mi mathvariant="bold">k</mi></msub></mrow><annotation encoding="application/x-tex">\bold{q_k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.63888em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span>对称/旋转后得到的点<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi mathvariant="bold">q</mi><mi mathvariant="bold">k</mi><mo mathvariant="bold" lspace="0em" rspace="0em">′</mo></msubsup></mrow><annotation encoding="application/x-tex">\bold{q&#x27;_k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.035em;vertical-align:-0.2831079999999999em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-2.4168920000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">k</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathbf mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2831079999999999em;"><span></span></span></span></span></span></span></span></span></span></span></li>
</ul>
  <img src="/2024/07/06/PRS-Net/symmetry_point.png" class="" width="500" height="100" title="对称点">
  <img src="/2024/07/06/PRS-Net/rotation_point.png" class="" width="500" height="100" title="旋转点">
<ul>
<li>第三步：计算每个点<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi mathvariant="bold">q</mi><mi mathvariant="bold">k</mi><mo mathvariant="bold" lspace="0em" rspace="0em">′</mo></msubsup></mrow><annotation encoding="application/x-tex">\bold{q&#x27;_k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.035em;vertical-align:-0.2831079999999999em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-2.4168920000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathbf mtight">k</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathbf mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2831079999999999em;"><span></span></span></span></span></span></span></span></span></span></span>到形状<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi></mrow><annotation encoding="application/x-tex">O</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span></span></span></span>的最短距离<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">D_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li>
</ul>
  <img src="/2024/07/06/PRS-Net/shortest_distance.png" class="" width="300" height="60" title="最短距离">
<ul>
<li>第四步：对所有对称平面的最短距离<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>D</mi><mo>^</mo></mover><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">\hat{D}_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0967699999999998em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9467699999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>和旋转轴的最短距离<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>D</mi><mo>~</mo></mover><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">\tilde{D}_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0701899999999998em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9201899999999998em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span><span style="top:-3.6023300000000003em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;"><span class="mord">~</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>求和，得到对称距离损失<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mrow><mi>s</mi><mi>d</mi></mrow></msub></mrow><annotation encoding="application/x-tex">L_{sd}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="mord mathnormal mtight">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li>
</ul>
  <img src="/2024/07/06/PRS-Net/Lsd.png" class="" width="400" height="100" title="对称距离损失">
<h2 id="42-规范化损失regularization-loss"><a class="markdownIt-Anchor" href="#42-规范化损失regularization-loss"></a> 4.2 规范化损失（Regularization Loss）</h2>
<p>惩罚接近平行的对称面/旋转轴</p>
<ul>
<li>第一步：定义对称面法向量/旋转轴的单位方向矩阵<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>M</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>M</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">M_1,M_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><img src="/2024/07/06/PRS-Net/M1.png" class="" width="300" height="40" title="单位方向矩阵">
<ul>
<li>例如对于对称面法向量/旋转轴<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mover accent="true"><mi>n</mi><mo>⃗</mo></mover><mn>1</mn></msub><mo>=</mo><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mn>0</mn><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo><mo separator="true">,</mo><mspace width="1em"/><msub><mover accent="true"><mi>n</mi><mo>⃗</mo></mover><mn>2</mn></msub><mo>=</mo><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo><mo separator="true">,</mo><mspace width="1em"/><msub><mover accent="true"><mi>n</mi><mo>⃗</mo></mover><mn>3</mn></msub><mo>=</mo><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\vec{n}_1=(1,0,0),\quad \vec{n}_2=(0,1,0),\quad \vec{n}_3=(0,0,1)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.864em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2355em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2355em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2355em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span></p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mover accent="true"><mi>v</mi><mo>⃗</mo></mover><mn>1</mn></msub><mo>=</mo><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo><mo separator="true">,</mo><mspace width="1em"/><msub><mover accent="true"><mi>v</mi><mo>⃗</mo></mover><mn>2</mn></msub><mo>=</mo><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo><mo separator="true">,</mo><mspace width="1em"/><msub><mover accent="true"><mi>v</mi><mo>⃗</mo></mover><mn>3</mn></msub><mo>=</mo><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mn>0</mn><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\vec{v}_1=(0,0,1),\quad \vec{v}_2=(0,1,0),\quad \vec{v}_3=(1,0,0)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.864em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.20772em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.20772em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.20772em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mclose">)</span></span></span></span></span></p>
</li>
<li>则单位方向矩阵为<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>M</mi><mn>1</mn></msub><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mspace width="1em"/><msub><mi>M</mi><mn>2</mn></msub><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">M_1=\begin{bmatrix}1&amp;0&amp;0\\0&amp;1&amp;0\\0&amp;0&amp;1\end{bmatrix}\quad M_2=\begin{bmatrix}0&amp;0&amp;1\\0&amp;1&amp;0\\1&amp;0&amp;0\end{bmatrix}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.6010299999999997em;vertical-align:-1.55002em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0510099999999998em;"><span style="top:-2.2500000000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎣</span></span></span><span style="top:-2.8099900000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-4.05101em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎡</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0510099999999998em;"><span style="top:-2.2500000000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎦</span></span></span><span style="top:-2.8099900000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-4.05101em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎤</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.6010299999999997em;vertical-align:-1.55002em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0510099999999998em;"><span style="top:-2.2500000000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎣</span></span></span><span style="top:-2.8099900000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-4.05101em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎡</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0510099999999998em;"><span style="top:-2.2500000000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎦</span></span></span><span style="top:-2.8099900000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-4.05101em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎤</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
</li>
</ul>
</li>
<li>第二步：计算矩阵<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">A</span></span></span></span>和<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span><br />
当<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>M</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>M</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">M_1,M_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>为正交矩阵时，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo separator="true">,</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">A,B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span>分别为零矩阵<img src="/2024/07/06/PRS-Net/AB.png" class="" width="200" height="80" title="矩阵AB">
</li>
<li>第三步：计算规范化损失，即<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo separator="true">,</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">A,B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span>矩阵的<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mi>r</mi><mi>o</mi><mi>b</mi><mi>e</mi><mi>n</mi><mi>i</mi><mi>u</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">Frobenius</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">o</span><span class="mord mathnormal">b</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mord mathnormal">i</span><span class="mord mathnormal">u</span><span class="mord mathnormal">s</span></span></span></span>范数之和<img src="/2024/07/06/PRS-Net/FNorm.png" class="" width="500" height="100" title="Frobenius范数">
</li>
</ul>
<h2 id="43-综合损失函数"><a class="markdownIt-Anchor" href="#43-综合损失函数"></a> 4.3 综合损失函数</h2>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mstyle mathsize="1.44em"><mi>L</mi><mo>=</mo><msub><mi>L</mi><mrow><mi>s</mi><mi>d</mi></mrow></msub><mo>+</mo><msub><mi>w</mi><mi>r</mi></msub><msub><mi>L</mi><mi>r</mi></msub></mstyle></mrow><annotation encoding="application/x-tex">\Large L=L_{sd}+w_rL_r
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9839952em;vertical-align:0em;"></span><span class="mord mathnormal sizing reset-size6 size8">L</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel sizing reset-size6 size8">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.1999952em;vertical-align:-0.216em;"></span><span class="mord sizing reset-size6 size8"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33224999999999993em;"><span style="top:-2.85em;margin-left:0em;margin-right:0.034722222222222224em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size8 size6 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="mord mathnormal mtight">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin sizing reset-size6 size8">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.1999952em;vertical-align:-0.216em;"></span><span class="mord sizing reset-size6 size8"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.149em;"><span style="top:-2.85em;margin-left:-0.02691em;margin-right:0.034722222222222224em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size8 size6 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord sizing reset-size6 size8"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.149em;"><span style="top:-2.85em;margin-left:0em;margin-right:0.034722222222222224em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size8 size6 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<p>其中<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mi>r</mi></msub></mrow><annotation encoding="application/x-tex">w_r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>是规范化损失在综合损失中的所占权重，训练时自行定义</p>
<h1 id="5-验证"><a class="markdownIt-Anchor" href="#5-验证"></a> 5 验证</h1>
<p>现实中的形状，往往不是恰有3个对称面/旋转轴，因此验证阶段需要去除的重复或不够好的对称面/旋转轴</p>
<h2 id="51-重复对称面旋转轴的去除"><a class="markdownIt-Anchor" href="#51-重复对称面旋转轴的去除"></a> 5.1 重复对称面/旋转轴的去除</h2>
<p>当对称面的二面角/旋转轴的夹角小于阈值（文中为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>π</mi><mi mathvariant="normal">/</mi><mn>6</mn></mrow><annotation encoding="application/x-tex">\pi/6</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mord">/</span><span class="mord">6</span></span></span></span>）时，去除对称距离误差（SDE）更大的一个</p>
<h2 id="52-较差对称面旋转轴的去除"><a class="markdownIt-Anchor" href="#52-较差对称面旋转轴的去除"></a> 5.2 较差对称面/旋转轴的去除</h2>
<p>当某个对称面/旋转轴的对称距离误差（SDE）大于阈值（文中为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>4</mn><mo>×</mo><mn>1</mn><msup><mn>0</mn><mrow><mo>−</mo><mn>4</mn></mrow></msup></mrow><annotation encoding="application/x-tex">4\times 10^{-4}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">4</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">4</span></span></span></span></span></span></span></span></span></span></span></span>）时，去除该对称面/旋转轴</p>
<h1 id="6-实验"><a class="markdownIt-Anchor" href="#6-实验"></a> 6 实验</h1>
<h2 id="61-数据集"><a class="markdownIt-Anchor" href="#61-数据集"></a> 6.1 数据集</h2>
<ul>
<li><strong>ShapeNet</strong>：包含55个类别的形状，共约51300个3D模型</li>
<li>选取<strong>80%</strong> 的数据作为<strong>训练集</strong>，<strong>20%</strong> 的数据作为<strong>测试集</strong></li>
</ul>
<h2 id="62-训练集数据增强"><a class="markdownIt-Anchor" href="#62-训练集数据增强"></a> 6.2 训练集数据增强</h2>
<ul>
<li>ShapeNet数据集中的形状通常轴对齐，且部分种类的模型较少</li>
<li>采用<strong>数据增强</strong>的方法，对每个模型进行<strong>随机旋转</strong>，在每个种类上得到4000个模型用于训练</li>
</ul>
<h2 id="63-测试集人工验证"><a class="markdownIt-Anchor" href="#63-测试集人工验证"></a> 6.3 测试集人工验证</h2>
<ul>
<li>人工验证并筛选出<strong>存在对称面/旋转轴的形状</strong>作为测试集</li>
<li>人工获取测试集形状的<strong>真实对称面/旋转轴</strong>，与模型输出进行比较</li>
<li>真实误差（Ground Truth Error，GTE）定义为：<img src="/2024/07/06/PRS-Net/GTE.png" class="" width="500" height="40" title="GTE">
</li>
</ul>
<h2 id="64-体素化预处理"><a class="markdownIt-Anchor" href="#64-体素化预处理"></a> 6.4 体素化预处理</h2>
<ul>
<li>表面采样<strong>1000</strong>个点</li>
<li>生成体素化输入的大小为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>32</mn><mo>×</mo><mn>32</mn><mo>×</mo><mn>32</mn></mrow><annotation encoding="application/x-tex">32\times32\times32</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">3</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">3</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">3</span><span class="mord">2</span></span></span></span></li>
</ul>
<h2 id="65-训练参数"><a class="markdownIt-Anchor" href="#65-训练参数"></a> 6.5 训练参数</h2>
<ul>
<li><strong>批大小</strong>为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mo>=</mo><mn>32</mn></mrow><annotation encoding="application/x-tex">b=32</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">3</span><span class="mord">2</span></span></span></span></li>
<li><strong>学习率</strong>为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>l</mi><mi>r</mi></msub><mo>=</mo><mn>0.01</mn></mrow><annotation encoding="application/x-tex">l_r=0.01</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.01968em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span><span class="mord">1</span></span></span></span></li>
<li><strong>规范化损失权重</strong>为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mi>r</mi></msub><mo>=</mo><mn>25</mn></mrow><annotation encoding="application/x-tex">w_r=25</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mord">5</span></span></span></span></li>
<li><strong>Adam</strong>优化器</li>
</ul>
<h1 id="7-结果和对比-参数选择等"><a class="markdownIt-Anchor" href="#7-结果和对比-参数选择等"></a> 7 结果和对比、参数选择等</h1>
<blockquote>
<p>详细内容请参考原文<a target="_blank" rel="noopener" href="https://arxiv.org/abs/1910.06511v6">PRS-Net: Planar Reflective Symmetry Detection Network</a></p>
</blockquote>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>





</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Jiaming He</span>
  </div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>

  <a href="https://github.com/A-CS99" class="github-corner" title="在 GitHub 上关注我" aria-label="在 GitHub 上关注我" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script>

  






  




  

  <script class="next-config" data-name="enableMath" type="application/json">false</script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css" integrity="sha256-UF1fgpAiu3tPJN/uCqEUHNe7pnr+QR0SQDNfgglgtcM=" crossorigin="anonymous">



</body>
</html>
